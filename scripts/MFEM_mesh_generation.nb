(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     47992,       1048]
NotebookOptionsPosition[     43685,        976]
NotebookOutlinePosition[     44200,        995]
CellTagsIndexPosition[     44157,        992]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MFEM Mesh Generation", "Title",
 CellChangeTimes->{{3.954330014916133*^9, 
  3.954330020234383*^9}},ExpressionUUID->"9788de24-1194-48ab-bc62-\
86f6514cb679"],

Cell["\<\
Instructions:\[LineSeparator]Use mesh tools to create an ElementMesh object \
for the mesh that you want. 
Set the proper conditions for the BoundaryElement attributes.
For 2D write \[OpenCurlyDoubleQuote]2\[CloseCurlyDoubleQuote] after \
numVertices.
Set the proper numbers for element type and boundary element type. 
Set the proper dimension.
Add all the relevant boundaryElement lists.
Export.\
\>", "Text",
 CellChangeTimes->{{3.959097714888536*^9, 3.959097754294754*^9}, {
  3.9590978189170103`*^9, 3.9590978596742268`*^9}, {3.959098072680134*^9, 
  3.9590981154864388`*^9}},ExpressionUUID->"1bddd4b0-13e5-4cf3-a30f-\
c63aa31ffe5a"],

Cell[BoxData[{
 RowBox[{"<<", "NDSolve`FEM`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MeshTools`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Notation`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "HKLaTeXWrite`"}]}], "Input",
 CellChangeTimes->{{3.954342552732596*^9, 3.95434255691647*^9}, {
  3.954342587161096*^9, 3.954342591316964*^9}, {3.957885857835404*^9, 
  3.957885860564177*^9}, {3.959098132246759*^9, 3.959098135188216*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"d0b869b7-0499-44e6-8ed0-a6bcb73cf0e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     SubscriptBox["R", "o"]},
    "NotationTemplateTag"], "]"}], ";", 
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     SubscriptBox["R", "i"]},
    "NotationTemplateTag"], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.957885868833476*^9, 3.957885910587365*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"14e1d674-671d-4fc0-ba21-ca9e2fec4475"],

Cell[CellGroupData[{

Cell["Mesh Generation", "Subsection",
 CellChangeTimes->{{3.956662882267436*^9, 3.956662889118659*^9}, 
   3.9569248081723413`*^9, 
   3.9569257183257923`*^9},ExpressionUUID->"9b1d7543-4d74-4654-b993-\
9efa61711d86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "=", "5"}], ";", 
  RowBox[{"W", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.9373062919349813`*^9, 3.9373063004610643`*^9}, 
   3.937306357993803*^9, {3.937306427666257*^9, 3.937306457094123*^9}, {
   3.937306502966145*^9, 3.937306522314703*^9}, {3.937394981147197*^9, 
   3.937395046054202*^9}, {3.937399643847664*^9, 3.9373996599995947`*^9}, {
   3.937400140464293*^9, 3.937400141175517*^9}, {3.937579658618421*^9, 
   3.937579862434188*^9}, {3.9375801221093597`*^9, 3.93758012258248*^9}, {
   3.937580239242893*^9, 3.93758023973629*^9}, {3.938007577485203*^9, 
   3.93800762906882*^9}, {3.938009746405835*^9, 3.938009785207424*^9}, {
   3.93801012049863*^9, 3.9380101304943953`*^9}, {3.93801298998673*^9, 
   3.938013006478539*^9}, {3.938684648714526*^9, 3.938684651484112*^9}, {
   3.93921790301969*^9, 3.939217957105443*^9}, {3.939302503377503*^9, 
   3.939302691590239*^9}, {3.939372557795566*^9, 3.939372558609613*^9}, {
   3.939372601969639*^9, 3.9393726335576763`*^9}, 3.939372717381441*^9, 
   3.939401570067809*^9, 3.9394016326689863`*^9, {3.9394152257312603`*^9, 
   3.939415226573049*^9}, {3.939415257658554*^9, 3.9394152628932533`*^9}, {
   3.939415416063787*^9, 3.939415453844077*^9}, {3.939415830848942*^9, 
   3.939415852308735*^9}, {3.939415909142765*^9, 3.9394159093021517`*^9}, {
   3.9394689123840027`*^9, 3.939468935711802*^9}, {3.939745253756406*^9, 
   3.939745288003005*^9}, {3.939820514032135*^9, 3.9398205745608873`*^9}, {
   3.939821490284358*^9, 3.939821494178149*^9}, {3.939821537727398*^9, 
   3.939821546334825*^9}, 3.939835576822968*^9, {3.9399171277721*^9, 
   3.93991713024515*^9}, {3.9404383793630877`*^9, 3.9404384072024717`*^9}, 
   3.9409504954239817`*^9, {3.9410395410801153`*^9, 3.941039546354917*^9}, {
   3.941039601737625*^9, 3.941039805604707*^9}, 3.941039896370927*^9, 
   3.941201512263102*^9, 3.94120160139497*^9, {3.94275741229235*^9, 
   3.942757499730151*^9}, {3.9427576812227*^9, 3.9427576830258703`*^9}, 
   3.9427577313212976`*^9, {3.9428408034273453`*^9, 3.942840804812841*^9}, {
   3.9431147446013727`*^9, 3.943114748509329*^9}, {3.9431147846403313`*^9, 
   3.943114793880455*^9}, {3.94640085609241*^9, 3.946400960237591*^9}, {
   3.94906356285465*^9, 3.949063578306692*^9}, {3.94925293463111*^9, 
   3.949252968060816*^9}, {3.9492531184278307`*^9, 3.949253120302555*^9}, {
   3.94926521165659*^9, 3.949265212495056*^9}, {3.949404792710246*^9, 
   3.949404804919428*^9}, {3.949404902896449*^9, 3.9494049030506687`*^9}, {
   3.949405286775538*^9, 3.949405306635274*^9}, {3.949448893552931*^9, 
   3.949448993081678*^9}, {3.949508210945902*^9, 3.949508216971786*^9}, 
   3.9495082766223183`*^9, {3.949508759435808*^9, 3.949508770943067*^9}, {
   3.949511354738744*^9, 3.949511385192009*^9}, 3.9495116745271177`*^9, {
   3.949511802964715*^9, 3.9495118033078127`*^9}, {3.9496100737979794`*^9, 
   3.949610080219406*^9}, {3.949764506465764*^9, 3.9497645401034613`*^9}, {
   3.950138221185499*^9, 3.950138225919252*^9}, {3.950138292113636*^9, 
   3.950138294364048*^9}, {3.9504650222900763`*^9, 3.950465026536516*^9}, {
   3.9506475638251543`*^9, 3.9506475885035954`*^9}, 3.952253738359824*^9, {
   3.9522537755610943`*^9, 3.952253778135014*^9}, {3.953891993136244*^9, 
   3.953891993817996*^9}, {3.956662573820776*^9, 3.956662576455533*^9}, {
   3.9567562554912157`*^9, 3.956756297645831*^9}, 3.9570164584684753`*^9, {
   3.957019339412846*^9, 3.957019339799881*^9}, 3.9570200272085247`*^9, {
   3.957112041975492*^9, 3.9571120421866093`*^9}, {3.957262504813715*^9, 
   3.957262511908882*^9}, 3.957262558445376*^9, {3.9572626928660088`*^9, 
   3.9572626959263773`*^9}, 3.9572644858613873`*^9, {3.957264645310783*^9, 
   3.957264647096402*^9}, {3.9573461036197*^9, 3.957346108740644*^9}, 
   3.957346138809926*^9, {3.9573463299346247`*^9, 3.957346370763022*^9}, {
   3.957346404247068*^9, 3.957346405150899*^9}, {3.9573465582065983`*^9, 
   3.957346558755313*^9}, 3.9574717200524282`*^9, {3.9578858421994677`*^9, 
   3.9578858511938667`*^9}, {3.958814530217368*^9, 3.95881454979874*^9}, {
   3.958814687710144*^9, 3.9588146885192633`*^9}, {3.958836350058668*^9, 
   3.958836359428668*^9}, {3.9588366082246027`*^9, 3.958836613511448*^9}, {
   3.958836708511807*^9, 3.958836709435088*^9}, {3.959096244474183*^9, 
   3.9590962583269043`*^9}, 
   3.959098127498452*^9},ExpressionUUID->"1eba8bd0-dd91-4152-be84-\
fc3a8d31df9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mesh", " ", "=", 
  RowBox[{"RectangleMesh", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"L", ",", "W"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"mesh", "[", 
    RowBox[{"\"\<Wireframe\>\"", "[", 
     RowBox[{"\"\<MeshElementStyle\>\"", "->", 
      RowBox[{"FaceForm", "[", "LightBlue", "]"}]}], "]"}], "]"}], ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.95881457202008*^9, 3.958814580689741*^9}, {
  3.9588146242289543`*^9, 3.95881465527334*^9}, {3.958814713158539*^9, 
  3.958814743305469*^9}, {3.9588364190662813`*^9, 3.9588364227057867`*^9}, {
  3.9588364650893583`*^9, 3.958836643652714*^9}, {3.958836712041493*^9, 
  3.958836712636979*^9}, {3.959096270368792*^9, 3.959096277610023*^9}, {
  3.959096310687769*^9, 3.959096345758411*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"92ce843d-a306-49c8-b64f-831dc898777c"],

Cell[BoxData[
 TagBox[
  RowBox[{"ElementMesh", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.`", ",", "5.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "5.`"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"QuadElement", "[", 
      RowBox[{
       StyleBox["\<\"<\"\>",
        ShowStringCharacters->False], "\[InvisibleSpace]", "25", 
       "\[InvisibleSpace]", 
       StyleBox["\<\">\"\>",
        ShowStringCharacters->False]}], "]"}], "}"}]}], "]"}],
  False,
  Editable->False,
  SelectWithContents->True]], "Output",
 CellChangeTimes->{{3.958836554846006*^9, 3.958836614519638*^9}, 
   3.9588366461821957`*^9, 3.958836712898725*^9, {3.9590963327104588`*^9, 
   3.959096346088545*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"1ee825ec-0ea1-404c-b57a-20dab4255742"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[None], GraphicsComplexBox[CompressedData["

1:eJx9kcsJgDAQRFdPHnNIA4J9uDVYguDZ1i3BD8yGfaiBZDLZ8JhNxnVftt7M
pmve+j+OGQeuTfesg+dyga/+zpGnWtzPfNULvPgtFzmohyK/I7+Lzz6Zixx5
qvjZ1zjP8dknc5FTPrRCNfgvfEf2zZyNewICHx4i
    "], 
    {FaceForm[RGBColor[0.87, 0.94, 1]], 
     PolygonBox[{{1, 7, 8, 2}, {2, 8, 9, 3}, {3, 9, 10, 4}, {4, 10, 11, 5}, {
      5, 11, 12, 6}, {7, 13, 14, 8}, {8, 14, 15, 9}, {9, 15, 16, 10}, {10, 16,
       17, 11}, {11, 17, 18, 12}, {13, 19, 20, 14}, {14, 20, 21, 15}, {15, 21,
       22, 16}, {16, 22, 23, 17}, {17, 23, 24, 18}, {19, 25, 26, 20}, {20, 26,
       27, 21}, {21, 27, 28, 22}, {22, 28, 29, 23}, {23, 29, 30, 24}, {25, 31,
       32, 26}, {26, 32, 33, 27}, {27, 33, 34, 28}, {28, 34, 35, 29}, {29, 35,
       36, 30}}]}]},
  Axes->True]], "Output",
 CellChangeTimes->{{3.958836554846006*^9, 3.958836614519638*^9}, 
   3.9588366461821957`*^9, 3.958836712898725*^9, {3.9590963327104588`*^9, 
   3.959096346090303*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"08bd0424-4e6d-4cf4-bf2f-362975b68ff3"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coords", "=", 
   RowBox[{
    RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}], "//", 
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"#", ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "7"}]}]}], "]"}], "&"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elements", "=", 
   RowBox[{"mesh", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.954330148346575*^9, 3.954330148348366*^9}, {
  3.954342683777225*^9, 3.9543426857720013`*^9}, {3.9545007995035353`*^9, 
  3.954500799809039*^9}, {3.954503942381206*^9, 3.954503945165112*^9}, {
  3.954503978009034*^9, 3.954504000292569*^9}, {3.954504989008259*^9, 
  3.954505009799987*^9}, {3.957885334046061*^9, 3.9578853377702923`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"789d5b54-c7d9-4820-b7aa-ae384f387b57"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numVertices", "=", 
   RowBox[{"Length", "[", "coords", "]"}]}], ";"}], "\n", 
 RowBox[{"numElements", "=", 
  RowBox[{"Length", "[", "elements", "]"}]}]}], "Input",
 CellChangeTimes->{{3.954330127461947*^9, 3.9543301274640703`*^9}, 
   3.954342690873969*^9, 3.954502288011747*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"18958834-7d00-4247-b30d-6fe437453604"],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{
  3.9545022886698923`*^9, 3.95450400196286*^9, 3.95450462994315*^9, 
   3.954505011407634*^9, 3.954506645109127*^9, 3.954596128863495*^9, 
   3.9578853501477327`*^9, 3.957885925926869*^9, 3.9588147474567957`*^9, 
   3.958814945198749*^9, {3.958836625649231*^9, 3.958836648769457*^9}, 
   3.9590963551381598`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"45cc8919-babf-4123-9c08-b77cecf35d13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Optional", ":", 
    RowBox[{"boundary", " ", "data"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"boundaryElements", "=", 
     RowBox[{
      RowBox[{"mesh", "[", "\"\<BoundaryElements\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"numBoundary", "=", 
    RowBox[{"Length", "[", "boundaryElements", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.954330127461947*^9, 3.9543301274640703`*^9}, {
   3.954342690873969*^9, 3.9543427101912107`*^9}, {3.954500628137362*^9, 
   3.9545006289159517`*^9}, 3.9545022868389387`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"f72b6fe8-1773-4e44-9f27-3f5e3880c9f3"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{3.954502290664075*^9, 3.954504003009132*^9, 
  3.954504631001626*^9, 3.954505012028603*^9, 3.95450664567045*^9, 
  3.954596134371491*^9, 3.957885382196116*^9, 3.957885926488317*^9, 
  3.958814751772312*^9, 3.9588149502057047`*^9, 3.958836650565135*^9, 
  3.959096359842444*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"e3852d7a-1d16-473b-93bd-337620cccde2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["boundaryElements"], "Input",
 CellChangeTimes->{{3.9590964989332*^9, 3.959096499987331*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"930e7f7d-7519-458f-87e4-f9f925d4142f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"24", ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"19", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "31"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"31", ",", "32"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"32", ",", "33"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"33", ",", "34"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"34", ",", "35"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35", ",", "36"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"36", ",", "30"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.959096501743311*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"70f3ce64-9262-41f2-8af8-4772651a789f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Assign", " ", "boundary", " ", "attributes"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.954508822965678*^9, 3.954508831492282*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"883b0c40-520d-4e4a-9136-7700d14d7c5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"boundary", " ", "at", " ", 
     SubscriptBox["X", "_"]}], "=", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"boundaryElements1", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"elcoords", ",", "belements1", ",", "zcoords", ",", "count"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"belements1", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"count", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"elcoords", " ", "=", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"elcoords", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "<=", " ", 
               "0.00001"}], " ", ",", " ", 
              RowBox[{"count", "+=", "1"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "elcoords", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"count", "==", "2"}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"belements1", ",", "i"}], "]"}]}], "\[IndentingNewLine]", 
          " ", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "boundaryElements"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "belements1"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.954500862073124*^9, 3.954501281569812*^9}, {
  3.9545013594093723`*^9, 3.954501386432088*^9}, {3.954501421156528*^9, 
  3.954501446042862*^9}, {3.9578854196146107`*^9, 3.9578854588915997`*^9}, {
  3.958814757931837*^9, 3.958814757991559*^9}, {3.9588148479763603`*^9, 
  3.958814862317162*^9}, {3.958836655028685*^9, 3.958836658659472*^9}, {
  3.95909636971981*^9, 3.9590963698106422`*^9}, {3.959096525802074*^9, 
  3.9590965272065907`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"93b8a334-ad33-4e9d-8d83-7f74a082ab57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"boundary", " ", "at", " ", 
     SubscriptBox["X", "_"]}], "=", "L"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"boundaryElements2", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"elcoords", ",", "belements2", ",", "zcoords", ",", "count"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"belements2", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"count", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"elcoords", " ", "=", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"elcoords", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}], "<=", " ", "0.0001"}],
               " ", ",", " ", 
              RowBox[{"count", "+=", "1"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "elcoords", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"count", "==", "2"}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"belements2", ",", "i"}], "]"}]}], "\[IndentingNewLine]", 
          " ", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "boundaryElements"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "belements2"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.954501488588303*^9, 3.95450151767111*^9}, {
   3.954596177062769*^9, 3.954596178175314*^9}, {3.957885440363572*^9, 
   3.957885451767995*^9}, {3.958814769533389*^9, 3.958814769600739*^9}, {
   3.958814850878717*^9, 3.958814863974807*^9}, {3.958836662194193*^9, 
   3.958836665690813*^9}, 3.9588368106124*^9, {3.959096387780817*^9, 
   3.9590963965832167`*^9}, {3.9590965311391287`*^9, 3.959096532046479*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"da5f191a-f804-4bc2-a46c-f89e8a5fe1ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Inner", " ", "surface"}], " ", ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["X", "1"], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["X", "2"], "2"]}], "]"}], " ", "<=", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["R", "i"], "+", "0.00001"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"boundaryElements3", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"elcoords", ",", "belements3", ",", "zcoords", ",", "count"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"belements3", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"count", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"elcoords", " ", "=", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"elcoords", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], " ", ">=", " ", 
               RowBox[{"(", 
                RowBox[{"L", "-", "0.0001"}], ")"}]}], ",", " ", 
              RowBox[{"count", "+=", "1"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "elcoords", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"count", "==", "2"}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"belements3", ",", "i"}], "]"}]}], "\[IndentingNewLine]", 
          " ", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "boundaryElements"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "belements3"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9545017176099453`*^9, 3.954501795235222*^9}, {
   3.9545961826180553`*^9, 3.95459618383064*^9}, {3.957885484256926*^9, 
   3.9578855916927*^9}, 3.957885671929628*^9, {3.9578857966708717`*^9, 
   3.9578858220899973`*^9}, {3.957885933130988*^9, 3.957885937334889*^9}, {
   3.958814801843431*^9, 3.958814804364966*^9}, {3.9588148714292307`*^9, 
   3.958814897104003*^9}, {3.958836686025269*^9, 3.958836731505303*^9}, {
   3.958836780303632*^9, 3.958836782131637*^9}, {3.958836817656206*^9, 
   3.9588368222504683`*^9}, {3.95909640872029*^9, 3.9590964252184963`*^9}, {
   3.959096536626185*^9, 3.9590965367226477`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a343706f-ec53-4f14-8d4d-4bec0cb2d2b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Inner", " ", "surface"}], " ", ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["X", "1"], "2"], "+", 
       SuperscriptBox[
        SubscriptBox["X", "2"], "2"]}], "]"}], " ", "<=", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["R", "i"], "+", "0.00001"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"boundaryElements4", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"elcoords", ",", "belements3", ",", "zcoords", ",", "count"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"belements3", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"count", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"elcoords", " ", "=", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"elcoords", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "2"}], "]"}], "]"}], " ", ">=", " ", 
               RowBox[{"(", 
                RowBox[{"W", "-", "0.0001"}], ")"}]}], ",", " ", 
              RowBox[{"count", "+=", "1"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "elcoords", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"count", "==", "2"}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"belements3", ",", "i"}], "]"}]}], "\[IndentingNewLine]", 
          " ", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "boundaryElements"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "belements3"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.957885612430683*^9, 3.957885622385243*^9}, 
   3.957885674052003*^9, {3.957885711692554*^9, 3.9578857119964*^9}, {
   3.957885746005267*^9, 3.957885758185484*^9}, 3.9578859404681396`*^9, {
   3.9590964391417828`*^9, 3.959096445802134*^9}, 3.959096540969758*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"eb33c0d3-7681-4294-a0fe-2bb7f5bb289b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"boundaryElements", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"boundaryElements1", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"boundaryElements2", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"boundaryElements3", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"boundaryElements4", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.954501265506513*^9, 3.954501310826618*^9}, {
   3.954501341521079*^9, 3.954501343608695*^9}, {3.954501462281102*^9, 
   3.9545014749100027`*^9}, {3.954501570582119*^9, 3.95450157570957*^9}, {
   3.95450180140065*^9, 3.954501808959208*^9}, {3.9578856262407093`*^9, 
   3.957885634473473*^9}, {3.9588149024299726`*^9, 3.9588149065272417`*^9}, {
   3.958814964322047*^9, 3.958814969397305*^9}, 3.959096450531299*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"0105c2d7-7a86-4f5f-a1ab-cd4b6722d9bd"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{{3.95450128344138*^9, 3.954501311334494*^9}, 
   3.9545013439914093`*^9, {3.954501389576025*^9, 3.9545013938496733`*^9}, {
   3.954501459343581*^9, 3.95450147516823*^9}, 3.9545015760461903`*^9, 
   3.9545018092667513`*^9, 3.954504009395607*^9, 3.954504634606204*^9, 
   3.9545050143691473`*^9, 3.954506647845626*^9, 3.95459618608993*^9, 
   3.9578856348353453`*^9, {3.957885703891322*^9, 3.957885713495262*^9}, {
   3.9578858021534567`*^9, 3.957885824233706*^9}, {3.957885942458948*^9, 
   3.957885945791925*^9}, 3.958814907536375*^9, 3.9588149697595673`*^9, 
   3.9588367409537897`*^9, 3.9588367843746967`*^9, 3.958836827702826*^9, 
   3.9590964512656813`*^9, 3.959096544228065*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"e4b146f5-d315-49e9-869a-8444778e503f"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.95450128344138*^9, 3.954501311334494*^9}, 
   3.9545013439914093`*^9, {3.954501389576025*^9, 3.9545013938496733`*^9}, {
   3.954501459343581*^9, 3.95450147516823*^9}, 3.9545015760461903`*^9, 
   3.9545018092667513`*^9, 3.954504009395607*^9, 3.954504634606204*^9, 
   3.9545050143691473`*^9, 3.954506647845626*^9, 3.95459618608993*^9, 
   3.9578856348353453`*^9, {3.957885703891322*^9, 3.957885713495262*^9}, {
   3.9578858021534567`*^9, 3.957885824233706*^9}, {3.957885942458948*^9, 
   3.957885945791925*^9}, 3.958814907536375*^9, 3.9588149697595673`*^9, 
   3.9588367409537897`*^9, 3.9588367843746967`*^9, 3.958836827702826*^9, 
   3.9590964512656813`*^9, 3.959096544229341*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"e1eb8433-0172-4621-9a13-29bc2f96b7b4"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.95450128344138*^9, 3.954501311334494*^9}, 
   3.9545013439914093`*^9, {3.954501389576025*^9, 3.9545013938496733`*^9}, {
   3.954501459343581*^9, 3.95450147516823*^9}, 3.9545015760461903`*^9, 
   3.9545018092667513`*^9, 3.954504009395607*^9, 3.954504634606204*^9, 
   3.9545050143691473`*^9, 3.954506647845626*^9, 3.95459618608993*^9, 
   3.9578856348353453`*^9, {3.957885703891322*^9, 3.957885713495262*^9}, {
   3.9578858021534567`*^9, 3.957885824233706*^9}, {3.957885942458948*^9, 
   3.957885945791925*^9}, 3.958814907536375*^9, 3.9588149697595673`*^9, 
   3.9588367409537897`*^9, 3.9588367843746967`*^9, 3.958836827702826*^9, 
   3.9590964512656813`*^9, 3.959096544230404*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"f156c712-8139-4eac-96ac-339080ad1702"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.95450128344138*^9, 3.954501311334494*^9}, 
   3.9545013439914093`*^9, {3.954501389576025*^9, 3.9545013938496733`*^9}, {
   3.954501459343581*^9, 3.95450147516823*^9}, 3.9545015760461903`*^9, 
   3.9545018092667513`*^9, 3.954504009395607*^9, 3.954504634606204*^9, 
   3.9545050143691473`*^9, 3.954506647845626*^9, 3.95459618608993*^9, 
   3.9578856348353453`*^9, {3.957885703891322*^9, 3.957885713495262*^9}, {
   3.9578858021534567`*^9, 3.957885824233706*^9}, {3.957885942458948*^9, 
   3.957885945791925*^9}, 3.958814907536375*^9, 3.9588149697595673`*^9, 
   3.9588367409537897`*^9, 3.9588367843746967`*^9, 3.958836827702826*^9, 
   3.9590964512656813`*^9, 3.959096544231477*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"48fc6faa-f8a5-4abb-8240-e00499f72070"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.95450128344138*^9, 3.954501311334494*^9}, 
   3.9545013439914093`*^9, {3.954501389576025*^9, 3.9545013938496733`*^9}, {
   3.954501459343581*^9, 3.95450147516823*^9}, 3.9545015760461903`*^9, 
   3.9545018092667513`*^9, 3.954504009395607*^9, 3.954504634606204*^9, 
   3.9545050143691473`*^9, 3.954506647845626*^9, 3.95459618608993*^9, 
   3.9578856348353453`*^9, {3.957885703891322*^9, 3.957885713495262*^9}, {
   3.9578858021534567`*^9, 3.957885824233706*^9}, {3.957885942458948*^9, 
   3.957885945791925*^9}, 3.958814907536375*^9, 3.9588149697595673`*^9, 
   3.9588367409537897`*^9, 3.9588367843746967`*^9, 3.958836827702826*^9, 
   3.9590964512656813`*^9, 3.959096544232736*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"7925ab64-4f08-4e36-85c1-f7752d8dc001"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Build", " ", "vertex", " ", "section"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vertexSection", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<vertices\\n\>\"", ",", 
       RowBox[{"ToString", "[", "numVertices", "]"}], ",", "\"\<\\n\>\"", ",", 
       RowBox[{"ToString", "[", "2", "]"}], ",", "\"\<\\n\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "7"}], "]"}], "]"}], 
            ",", "\"\< \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "7"}], "]"}], "]"}], 
            ",", "\"\<\\n\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "coords"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.954330127461947*^9, 3.9543301274640703`*^9}, {
  3.954342690873969*^9, 3.954342713876039*^9}, {3.954500257790917*^9, 
  3.954500261779928*^9}, {3.9545024251496143`*^9, 3.954502425552692*^9}, {
  3.954502515144606*^9, 3.954502518170843*^9}, {3.954504814670649*^9, 
  3.95450483433138*^9}, {3.9545049451015167`*^9, 3.954504954974708*^9}, {
  3.954506359337575*^9, 3.954506372466964*^9}, {3.959096561101015*^9, 
  3.959096561666033*^9}, {3.9590968610023327`*^9, 3.959096861069963*^9}, {
  3.959097956617456*^9, 3.959098005474127*^9}, {3.9590980415025663`*^9, 
  3.95909804157968*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"e7170108-f5f0-4db9-88a3-c020a2376aa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Build", " ", "elements", " ", "section"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"elementSection", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<elements\\n\>\"", ",", 
      RowBox[{"ToString", "[", "numElements", "]"}], ",", "\"\<\\n\>\"", ",", 
      
      RowBox[{"StringJoin", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<1 3 \>\"", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"1", "=", 
              RowBox[{"region", " ", "attr"}]}], ",", 
             RowBox[{"3", "=", "square"}], ",", " ", 
             RowBox[{"4", "=", "tetrahedron"}], ",", " ", 
             RowBox[{"5", "=", "cuboid"}]}], "*)"}], 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", 
              RowBox[{"(", 
               RowBox[{"elem", "-", "1"}], ")"}]}], ",", "\"\< \>\""}], "]"}],
            ",", "\"\<\\n\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"elem", ",", "elements"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.954330127461947*^9, 3.9543301274640703`*^9}, {
   3.954342690873969*^9, 3.9543427403685837`*^9}, {3.954500375057373*^9, 
   3.954500386334901*^9}, {3.954500468894799*^9, 3.954500469272635*^9}, {
   3.954504210412941*^9, 3.954504210453657*^9}, 3.9588150299705*^9, {
   3.958836843332032*^9, 3.958836849596673*^9}, {3.9590965911747513`*^9, 
   3.959096601859213*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"deea76e9-2e06-4223-9b11-67816a5d0486"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Boundary", " ", "section"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"boundarySection1", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<boundary\\n\>\"", ",", 
      RowBox[{"ToString", "[", "numBoundary", "]"}], ",", "\"\<\\n\>\"", ",", 
      
      RowBox[{"StringJoin", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<1 1 \>\"", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"1", "=", 
              RowBox[{"boundary", " ", "attr"}]}], ",", " ", 
             RowBox[{"1", "=", 
              RowBox[{"line", " ", "segment"}]}], ",", " ", 
             RowBox[{"2", "=", "triangle"}], ",", " ", 
             RowBox[{"3", "=", "square"}]}], "*)"}], 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", 
              RowBox[{"(", 
               RowBox[{"b", "-", "1"}], ")"}]}], ",", "\"\< \>\""}], "]"}], 
           ",", "\"\<\\n\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "boundaryElements1"}], "}"}]}], "]"}], "]"}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.954330127461947*^9, 3.9543301274640703`*^9}, {
   3.954342690873969*^9, 3.954342746950783*^9}, {3.954500376367896*^9, 
   3.954500381395912*^9}, {3.954500574894125*^9, 3.954500575162345*^9}, {
   3.9545008483562603`*^9, 3.954500851699006*^9}, 3.954501585187468*^9, 
   3.954501622026997*^9, {3.954504208726709*^9, 3.954504208819669*^9}, {
   3.958815039773445*^9, 3.9588150661055193`*^9}, {3.959096634582267*^9, 
   3.9590966560516367`*^9}, {3.95909792125912*^9, 3.959097922722948*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"2cbf12df-fbeb-4c1f-8bbc-a4f1e894cc94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundarySection2", "=", 
   RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<2 1 \>\"", ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"2", "=", 
            RowBox[{"boundary", " ", "attr"}]}], ",", " ", 
           RowBox[{"1", "=", 
            RowBox[{"line", " ", "segment"}]}], ",", " ", 
           RowBox[{"2", "=", "triangle"}], ",", " ", 
           RowBox[{"3", "=", "square"}]}], "*)"}], 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"ToString", "/@", 
            RowBox[{"(", 
             RowBox[{"b", "-", "1"}], ")"}]}], ",", "\"\< \>\""}], "]"}], 
         ",", "\"\<\\n\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "boundaryElements2"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.954501628800029*^9, 3.954501644299375*^9}, {
  3.954501682727283*^9, 3.954501682872961*^9}, {3.954504207415938*^9, 
  3.954504207481451*^9}, {3.958815041316921*^9, 3.958815060228487*^9}, {
  3.959096643796699*^9, 3.959096657577466*^9}, {3.959097928708241*^9, 
  3.95909792887529*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"096223b3-44b6-4c62-bd50-2e0f13be8b94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundarySection3", "=", 
   RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<3 1 \>\"", ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"3", "=", 
            RowBox[{"boundary", " ", "attr"}]}], ",", " ", 
           RowBox[{"1", "=", 
            RowBox[{"line", " ", "segment"}]}], ",", " ", 
           RowBox[{"2", "=", "triangle"}], ",", " ", 
           RowBox[{"3", "=", "square"}]}], "*)"}], 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"ToString", "/@", 
            RowBox[{"(", 
             RowBox[{"b", "-", "1"}], ")"}]}], ",", "\"\< \>\""}], "]"}], 
         ",", "\"\<\\n\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "boundaryElements3"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.954501834498848*^9, 3.954501840116652*^9}, {
  3.954504212040169*^9, 3.954504212128406*^9}, {3.958815042897622*^9, 
  3.958815057155588*^9}, {3.959096645968452*^9, 3.959096659281413*^9}, {
  3.959097930522956*^9, 3.959097930687173*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"58e64dd3-1d22-4989-9b56-c9a1a068a45d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundarySection4", "=", 
   RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<4 1 \>\"", ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"1", "=", 
            RowBox[{"boundary", " ", "attr"}]}], ",", " ", 
           RowBox[{"1", "=", 
            RowBox[{"line", " ", "segment"}]}], ",", " ", 
           RowBox[{"2", "=", "triangle"}]}], "*)"}], 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"ToString", "/@", 
            RowBox[{"(", 
             RowBox[{"b", "-", "1"}], ")"}]}], ",", "\"\< \>\""}], "]"}], 
         ",", "\"\<\\n\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "boundaryElements4"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9578860048312073`*^9, 3.9578860261932783`*^9}, {
  3.959096647160185*^9, 3.9590966621858397`*^9}, {3.959097933350626*^9, 
  3.959097933498033*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b3f8037a-23dd-4a00-adb7-2715322eb223"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mfemMeshContent", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<MFEM mesh v1.0\\n\\n\>\"", ",", 
      RowBox[{
      "\"\<dimension\\n\>\"", "<>", "\"\<2\>\"", "<>", "\"\<\\n\\n\>\""}], 
      ",", "elementSection", ",", "\"\<\\n\>\"", ",", "boundarySection1", ",",
       "boundarySection2", ",", "boundarySection3", ",", "boundarySection4", 
      ",", "\"\<\\n\>\"", ",", "vertexSection"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "the", " ", "dimension", " ", "appropriately"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.9545003584139223`*^9, 3.954500358416271*^9}, {
   3.9545006599292603`*^9, 3.954500708546586*^9}, {3.9545016516189528`*^9, 
   3.954501660097192*^9}, {3.954501844380411*^9, 3.954501848255422*^9}, {
   3.9578861982565393`*^9, 3.957886198939749*^9}, 3.958815078213018*^9, {
   3.95909666484638*^9, 3.9590966686774683`*^9}, {3.959096940118862*^9, 
   3.95909694021911*^9}, {3.959097941333536*^9, 3.9590979537174587`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"6c0df219-6bea-484a-8553-fdd5302a19f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.954500736180483*^9, 3.9545007476740837`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7343a0a9-959a-4226-8a0b-f45d35d80f1d"],

Cell[BoxData["\<\"/Users/Aashutosh/Academic/Software/MFEM/Projects/MeshFiles\"\
\>"], "Output",
 CellChangeTimes->{
  3.9545007481338797`*^9, 3.954500804476408*^9, 3.9545016628169823`*^9, 
   3.954501850520525*^9, 3.954504028077622*^9, 3.954504218986615*^9, 
   3.954504658589891*^9, 3.954505020028038*^9, 3.95450638161686*^9, 
   3.954506657836532*^9, 3.954596205275997*^9, 3.9578860397835197`*^9, 
   3.957886200567767*^9, 3.958815088689682*^9, 3.958836862723349*^9, 
   3.959096670680582*^9, {3.959096867356772*^9, 3.959096890683714*^9}, 
   3.959096941752098*^9, 3.959098011380074*^9, 3.959098052463883*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"b0ae757f-2ce8-497d-bf4d-da7a2fbcfe1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<Rectangle-quad.mesh\>\"", ",", "mfemMeshContent", ",", 
   "\"\<Text\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9545003675332193`*^9, 3.954500367535372*^9}, {
  3.9545007129297323`*^9, 3.954500731906549*^9}, {3.954504660341956*^9, 
  3.954504663739441*^9}, {3.9545066591352386`*^9, 3.954506659796735*^9}, {
  3.9545962080130987`*^9, 3.9545962081281643`*^9}, {3.957886060582135*^9, 
  3.957886079335211*^9}, {3.958815093382965*^9, 3.958815098710318*^9}, {
  3.958815177644779*^9, 3.958815179638259*^9}, {3.958836871503146*^9, 
  3.958836874375123*^9}, {3.959096675351976*^9, 3.959096705373006*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"14c0f6dc-a51e-4102-9f2a-64a194458681"],

Cell[BoxData["\<\"Rectangle-quad.mesh\"\>"], "Output",
 CellChangeTimes->{
  3.95450075137428*^9, 3.954500806459285*^9, 3.9545016634690437`*^9, 
   3.954501851258399*^9, 3.954501887734374*^9, 3.954502312956509*^9, 
   3.9545024294780493`*^9, {3.954502495109*^9, 3.95450252455116*^9}, 
   3.954504029433601*^9, 3.954504219551382*^9, 3.954504666194311*^9, 
   3.954504839928383*^9, 3.954504959430554*^9, 3.9545050205360394`*^9, 
   3.954506382544036*^9, 3.954506660534822*^9, 3.954596209376583*^9, 
   3.957886083036002*^9, 3.957886201636664*^9, 3.958815103541154*^9, 
   3.958815184633877*^9, 3.9588368786819572`*^9, 3.959096706051223*^9, {
   3.9590968682677517`*^9, 3.959096891450556*^9}, 3.9590969422343884`*^9, 
   3.9590980119192457`*^9, 3.9590980529289083`*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"f3d135de-16b7-4275-9288-2cb24b46f7c0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{{"KeyDown", "~"} :> 
  HKLaTeXWrite`ReplaceSelectionWithFunction[]},
WindowSize->{1728, 1051},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"618507ec-bdab-4276-84d8-5be9a4da5f52"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 163, 3, 144, "Title",ExpressionUUID->"9788de24-1194-48ab-bc62-86f6514cb679"],
Cell[742, 27, 648, 14, 280, "Text",ExpressionUUID->"1bddd4b0-13e5-4cf3-a30f-c63aa31ffe5a"],
Cell[1393, 43, 518, 8, 135, "Input",ExpressionUUID->"d0b869b7-0499-44e6-8ed0-a6bcb73cf0e4"],
Cell[1914, 53, 412, 11, 57, "Input",ExpressionUUID->"14e1d674-671d-4fc0-ba21-ca9e2fec4475"],
Cell[CellGroupData[{
Cell[2351, 68, 216, 4, 79, "Subsection",ExpressionUUID->"9b1d7543-4d74-4654-b993-9efa61711d86"],
Cell[2570, 74, 4419, 63, 44, "Input",ExpressionUUID->"1eba8bd0-dd91-4152-be84-fc3a8d31df9b"],
Cell[CellGroupData[{
Cell[7014, 141, 1061, 23, 74, "Input",ExpressionUUID->"92ce843d-a306-49c8-b64f-831dc898777c"],
Cell[8078, 166, 842, 24, 50, "Output",ExpressionUUID->"1ee825ec-0ea1-404c-b57a-20dab4255742"],
Cell[8923, 192, 1089, 20, 573, "Output",ExpressionUUID->"08bd0424-4e6d-4cf4-bf2f-362975b68ff3"]
}, Open  ]],
Cell[10027, 215, 874, 20, 74, "Input",ExpressionUUID->"789d5b54-c7d9-4820-b7aa-ae384f387b57"],
Cell[CellGroupData[{
Cell[10926, 239, 396, 8, 74, "Input",ExpressionUUID->"18958834-7d00-4247-b30d-6fe437453604"],
Cell[11325, 249, 441, 7, 50, "Output",ExpressionUUID->"45cc8919-babf-4123-9c08-b77cecf35d13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11803, 261, 744, 17, 105, "Input",ExpressionUUID->"f72b6fe8-1773-4e44-9f27-3f5e3880c9f3"],
Cell[12550, 280, 405, 6, 50, "Output",ExpressionUUID->"e3852d7a-1d16-473b-93bd-337620cccde2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12992, 291, 185, 2, 44, "Input",ExpressionUUID->"930e7f7d-7519-458f-87e4-f9f925d4142f"],
Cell[13180, 295, 1380, 44, 80, "Output",ExpressionUUID->"70f3ce64-9262-41f2-8af8-4772651a789f"]
}, Open  ]],
Cell[14575, 342, 263, 5, 44, "Input",ExpressionUUID->"883b0c40-520d-4e4a-9136-7700d14d7c5c"],
Cell[14841, 349, 2562, 55, 564, "Input",ExpressionUUID->"93b8a334-ad33-4e9d-8d83-7f74a082ab57"],
Cell[17406, 406, 2528, 54, 564, "Input",ExpressionUUID->"da5f191a-f804-4bc2-a46c-f89e8a5fe1ac"],
Cell[19937, 462, 3115, 69, 567, "Input",ExpressionUUID->"a343706f-ec53-4f14-8d4d-4bec0cb2d2b8"],
Cell[23055, 533, 2761, 64, 567, "Input",ExpressionUUID->"eb33c0d3-7681-4294-a0fe-2bb7f5bb289b"],
Cell[CellGroupData[{
Cell[25841, 601, 875, 12, 166, "Input",ExpressionUUID->"0105c2d7-7a86-4f5f-a1ab-cd4b6722d9bd"],
Cell[26719, 615, 811, 11, 50, "Output",ExpressionUUID->"e4b146f5-d315-49e9-869a-8444778e503f"],
Cell[27533, 628, 810, 11, 50, "Output",ExpressionUUID->"e1eb8433-0172-4621-9a13-29bc2f96b7b4"],
Cell[28346, 641, 810, 11, 50, "Output",ExpressionUUID->"f156c712-8139-4eac-96ac-339080ad1702"],
Cell[29159, 654, 810, 11, 50, "Output",ExpressionUUID->"48fc6faa-f8a5-4abb-8240-e00499f72070"],
Cell[29972, 667, 810, 11, 50, "Output",ExpressionUUID->"7925ab64-4f08-4e36-85c1-f7752d8dc001"]
}, Open  ]],
Cell[30797, 681, 1921, 42, 135, "Input",ExpressionUUID->"e7170108-f5f0-4db9-88a3-c020a2376aa0"],
Cell[32721, 725, 1623, 37, 135, "Input",ExpressionUUID->"deea76e9-2e06-4223-9b11-67816a5d0486"],
Cell[34347, 764, 1797, 39, 135, "Input",ExpressionUUID->"2cbf12df-fbeb-4c1f-8bbc-a4f1e894cc94"],
Cell[36147, 805, 1340, 31, 105, "Input",ExpressionUUID->"096223b3-44b6-4c62-bd50-2e0f13be8b94"],
Cell[37490, 838, 1292, 30, 105, "Input",ExpressionUUID->"58e64dd3-1d22-4989-9b56-c9a1a068a45d"],
Cell[38785, 870, 1151, 28, 105, "Input",ExpressionUUID->"b3f8037a-23dd-4a00-adb7-2715322eb223"],
Cell[39939, 900, 1115, 20, 105, "Input",ExpressionUUID->"6c0df219-6bea-484a-8553-fdd5302a19f0"],
Cell[CellGroupData[{
Cell[41079, 924, 251, 4, 44, "Input",ExpressionUUID->"7343a0a9-959a-4226-8a0b-f45d35d80f1d"],
Cell[41333, 930, 690, 10, 50, "Output",ExpressionUUID->"b0ae757f-2ce8-497d-bf4d-da7a2fbcfe1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42060, 945, 737, 12, 44, "Input",ExpressionUUID->"14c0f6dc-a51e-4102-9f2a-64a194458681"],
Cell[42800, 959, 845, 12, 50, "Output",ExpressionUUID->"f3d135de-16b7-4275-9288-2cb24b46f7c0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

